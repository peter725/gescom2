<form [formGroup]="form" class="grid grid-cols-1 gap-1.5">
  <mat-form-field>
    <mat-label>{{ "fields.module" | translate }}</mat-label>
    <tsw-custom-select
      resourceName="modules"
      formControlName="module"
    ></tsw-custom-select>
  </mat-form-field>

  <mat-checkbox formControlName="usePreviousQuery" class="ml-1">
    Reutilizar consulta
  </mat-checkbox>

  <ng-container *ngIf="form.value.usePreviousQuery">
    <!--   <mat-form-field
      *ngIf="form.value.usePreviousQuery"
      class="w-full mt-4">
      <mat-label>Buscar / Consultar</mat-label>
      <input type="text" [formControl]="searchCtrl">
    </mat-form-field> -->

    <tsw-table-container
      class="pt-3"
      [loading]="loading"
      [paginator]="paginator"
      [columns]="columns"
      (reload)="reloadData()"
      (page)="navigatePage($event)"
    >
      <table
        tsw-table
        [dataSource]="dataArray"
        matSort
        (matSortChange)="sortData($event)"
      >
        <tr
          mat-header-row
          *matHeaderRowDef="(columns.columns | async) ?? []; sticky: true"
        ></tr>
        <tr mat-row *matRowDef="let row; columns: (columns.columns | async) ?? []"></tr>

        <tr
          *matNoDataRow
          tsw-table-empty-row
          [loading]="loading"
          [columns]="columns"
        ></tr>

        <ng-container matColumnDef="select" [sticky]="true">
          <th mat-header-cell *matHeaderCellDef>
            <mat-checkbox
              (click)="$event.stopPropagation()"
              (change)="selectAll($event)"
              [checked]="
                selection.hasValue() &&
                source.data.length === selection.selected.length
              "
              [indeterminate]="
                selection.hasValue() &&
                source.data.length !== selection.selected.length
              "
            ></mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox
              (click)="$event.stopPropagation()"
              (change)="select($event, row)"
              [checked]="selection.isSelected(row)"
            ></mat-checkbox>
          </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>
            {{ "fields.name" | translate }}
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions" [stickyEnd]="true">
          <th mat-header-cell *matHeaderCellDef class="opacity-0"></th>
          <td mat-cell *matCellDef="let element" class="text-right">
            <ng-container>
              <button mat-button matTooltip="Extender">
                <mat-icon>extension</mat-icon>
              </button>
              <button mat-button matTooltip="Visualizar">
                <mat-icon>visibility</mat-icon>
              </button>
            </ng-container>
          </td>
        </ng-container>
      </table>
    </tsw-table-container>
  </ng-container>
</form>
